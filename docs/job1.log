[0KRunning with gitlab-runner 16.1.0 (b72e108d)[0;m
[0K  on gitlab-runner-5f45fb4598-tv28r t1_mhdkB, system ID: r_QiWxum8kMcmu[0;m
section_start:1740998003:prepare_executor[0K[0K[36;1mPreparing the "kubernetes" executor[0;m[0;m
[0KUsing Kubernetes namespace: default[0;m
[0KUsing Kubernetes executor with image kroniak/ssh-client:3.19 ...[0;m
[0KUsing attach strategy to execute scripts...[0;m
section_end:1740998003:prepare_executor[0Ksection_start:1740998003:prepare_script[0K[0K[36;1mPreparing environment[0;m[0;m
Waiting for pod default/runner-t1mhdkb-project-335-concurrent-0b2x49 to be running, status is Pending
Running on runner-t1mhdkb-project-335-concurrent-0b2x49 via gitlab-runner-5f45fb4598-tv28r...

section_end:1740998007:prepare_script[0Ksection_start:1740998007:get_sources[0K[0K[36;1mGetting source from Git repository[0;m[0;m
[32;1mFetching changes with git depth set to 20...[0;m
Initialized empty Git repository in /builds/team-14/lotti/.git/
[32;1mCreated fresh repository.[0;m
[32;1mChecking out 3238f3aa as detached HEAD (ref is master)...[0;m

[32;1mSkipping Git submodules setup[0;m

section_end:1740998008:get_sources[0Ksection_start:1740998008:step_script[0K[0K[36;1mExecuting "step_script" stage of the job script[0;m[0;m
[32;1m$ mkdir -p ~/.ssh && chmod 700 ~/.ssh[0;m
[32;1m$ echo -e "Host *\n\tStrictHostKeyChecking no\n\n" > ~/.ssh/config && chmod 600 ~/.ssh/config[0;m
[32;1m$ echo "$SSH_PRIVATE_KEY_BASE64" | base64 -d > ~/.ssh/id_rsa && chmod 400 ~/.ssh/id_rsa[0;m
[32;1m$ ssh-agent sh -c "ssh-add ~/.ssh/id_rsa"[0;m
Identity added: /root/.ssh/id_rsa (/root/.ssh/id_rsa)
[32;1m$ ssh-keyscan -H "$SSH_HOST"[0;m
# prod-team-14-mkg8u20m.final.prodcontest.ru:22 SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.8
|1|0NKFM7akyWb+3egk9SsbX0EuoD8=|t4/T0DIXCjwUc/dutUBbaCKuFQU= ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCpGrtHv0K2QDIwv6M0slCr76KgOb/vcqlZ6YoQ5444hzgpgjUlUJJBdnKg597T0W1z0zNmlIRXXnQAQHM37qwhj+ygm4w39M+8aoBZYduM5L7caMeyAMSS02VuqO/NzpQxfJXizdKiVW4W4TYyBB3wZd9tTWkLsi8KxfJpk84dMQTyu+ZlgDA6eFgB9vDNa1ADMuPkkAT6NbkyAGT3gEVWpnUcMEwvOwg0PMnL6gkaGukAggZTcMfaAYSYYDqj5qfhqpoxLDQnjq367/oH2vllgvcSowK1Od6Nh8CqrLuH7L4aUcn7kn0Xt1zI8TGL1uFr2kekIZ1CG2hRtd/pJWQxnL9CxiMg/ZbSbn7KgpvI7ZwxM6IjrPXB4tE2ZZWm4Uu34lYO3sT509shGqeeuO0MwQ+0SDcLy9fvfLJziH6Acd1CarIJx9NXLTCLYWMWduBKAr9v7Q74x/D71Q2p/oK7gJktFaD5oGwvRGPLTkSh2Q75TSnrtMIDUpycHr4+v1U=
# prod-team-14-mkg8u20m.final.prodcontest.ru:22 SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.8
# prod-team-14-mkg8u20m.final.prodcontest.ru:22 SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.8
# prod-team-14-mkg8u20m.final.prodcontest.ru:22 SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.8
# prod-team-14-mkg8u20m.final.prodcontest.ru:22 SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.8
|1|g7LtKPW5dse4BDVygL+NO6BxazU=|Ht536+lACE+lAospNwVWTlVpfdA= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBGPFggxsDVI/biZX178BV8KDXikYfk8sGYsNZupkeeQ0b6/X8HaPjfY1+IGy6IyEmwPPirxgebJhxanoecUHstU=
|1|HEKwuo2JhPX2t3ts5xcbBU3uXdo=|7vZDlS8tDf/OQCe2S7Rm6g//Qpc= ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILAjaNUykmeO2tfp2aSR5ERmuWrLSoWcFa0eDwAVs2XX
[32;1m$ apk add gettext[0;m
fetch https://dl-cdn.alpinelinux.org/alpine/v3.19/main/x86_64/APKINDEX.tar.gz
fetch https://dl-cdn.alpinelinux.org/alpine/v3.19/community/x86_64/APKINDEX.tar.gz
(1/8) Installing libintl (0.22.3-r0)
(2/8) Installing gettext-envsubst (0.22.3-r0)
(3/8) Installing libgomp (13.2.1_git20231014-r0)
(4/8) Installing libunistring (1.1-r2)
(5/8) Installing gettext-libs (0.22.3-r0)
(6/8) Installing xz-libs (5.4.5-r0)
(7/8) Installing libxml2 (2.11.8-r0)
(8/8) Installing gettext (0.22.3-r0)
Executing busybox-1.36.1-r19.trigger
OK: 20 MiB in 32 packages
[32;1m$ envsubst < docker-compose.tmpl > docker-compose.yml[0;m
[32;1m$ AUTH_COMMAND="echo "$CI_REGISTRY_PASSWORD" | docker login $CI_REGISTRY --username $CI_REGISTRY_USER --password-stdin";[0;m
[32;1m$ ssh $SSH_ADDRESS "$AUTH_COMMAND"[0;m
Warning: Permanently added 'prod-team-14-mkg8u20m.final.prodcontest.ru' (ED25519) to the list of known hosts.
Login Succeeded
WARNING! Your password will be stored unencrypted in /home/ubuntu/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

[32;1m$ ssh $SSH_ADDRESS "docker pull $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA"[0;m
3238f3aaeea52b23566b9582d231e33c17dbd3aa: Pulling from team-14/lotti
f18232174bc9: Already exists
d745a1d9a3fc: Already exists
fd61d778b859: Pulling fs layer
427a96c0482d: Pulling fs layer
4313ea5000bd: Pulling fs layer
37ab1266537d: Pulling fs layer
83fb2a0cca52: Pulling fs layer
37ab1266537d: Waiting
83fb2a0cca52: Waiting
fd61d778b859: Download complete
427a96c0482d: Verifying Checksum
427a96c0482d: Download complete
4313ea5000bd: Verifying Checksum
4313ea5000bd: Download complete
fd61d778b859: Pull complete
83fb2a0cca52: Verifying Checksum
83fb2a0cca52: Download complete
427a96c0482d: Pull complete
4313ea5000bd: Pull complete
37ab1266537d: Verifying Checksum
37ab1266537d: Download complete
37ab1266537d: Pull complete
83fb2a0cca52: Pull complete
Digest: sha256:60d8e98d5fe9a9da9c4f5638d19cfe8c808e2a6f89c1c7f7fc263e436d04775b
Status: Downloaded newer image for gitlab.prodcontest.ru:5050/team-14/lotti:3238f3aaeea52b23566b9582d231e33c17dbd3aa
gitlab.prodcontest.ru:5050/team-14/lotti:3238f3aaeea52b23566b9582d231e33c17dbd3aa
[32;1m$ ssh $SSH_ADDRESS "docker stop $CI_PROJECT_NAME || true"[0;m
Error response from daemon: No such container: lotti
[32;1m$ ssh $SSH_ADDRESS "docker rm $CI_PROJECT_NAME || true"[0;m
Error response from daemon: No such container: lotti
[32;1m$ scp docker-compose.yml $SSH_ADDRESS:~/[0;m
[32;1m$ ssh $SSH_ADDRESS "cd ~/; docker compose up -d"[0;m
time="2025-03-03T10:33:34Z" level=warning msg="/home/ubuntu/docker-compose.yml: the attribute `version` is obsolete, it will be ignored, please remove it to avoid potential confusion"
 Container postgres  Running
 Container redis  Running
 Container minio_container  Running
 Container nginx_container  Stopping
 Container nginx_container  Stopped
 Container backend  Recreate
 Container backend  Recreated
 Container nginx_container  Created
 Container postgres  Waiting
 Container postgres  Healthy
 Container backend  Starting
 Container backend  Started
 Container nginx_container  Starting
 Container nginx_container  Started

section_end:1740998027:step_script[0Ksection_start:1740998027:cleanup_file_variables[0K[0K[36;1mCleaning up project directory and file based variables[0;m[0;m

section_end:1740998027:cleanup_file_variables[0K[32;1mJob succeeded[0;m
